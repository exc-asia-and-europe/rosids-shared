<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>a title</title>
        <meta charset="UTF-8"/>
        <link href="/exist/apps/cluster-shared/resources/script/vendor/select2/select2.css" rel="stylesheet"/>
        <script type="text/javascript" src="resources/script/vendor/jquery/dist/jquery.min.js"/>
        <script type="text/javascript" src="resources/script/vendor/select2/select2.min.js"/>
        <style>
            #custom {
                display: block;
            }
        </style>
    </head>
    <body>
        <div>
            <label for="global">Vocab</label>
            <input id="global" type="hidden" autocomplete="off" value="100"/>
            <!-- select  name="global">
                <option value="default">EXC/AAT</option>
                <option value="custom">Custom</option>
            </select -->
            <span id="custom">
                <label for="custom">Custom</label>
                <select id="custom-select" name="custom">
                    <option value="custom">Custom</option>
                </select>
            </span>
        </div>
        <script type="text/javascript">
            function format(repository, container, query) {
                return repository.name
            };
            $(document).ready(function() {
               
                $( "#global" ).select2({
                    formatResult: format,
                    formatSelection: function (repository) {
                        return repository.name;
                    },
                    initSelection: function(element, callback) {
                        $.ajax("modules/repositories/repositories.xq?group=global", {
                            dataType: "json"
                        }).done(function(data) {
                            console.log("Data:", data);
                            callback(data.repository);
                        });
                    },
                    ajax: {
                        url: "modules/repositories/repositories.xq?group=custom",
                        dataType: "json",
                        crossDomain: true,
                        results: function (data, page) {
                            return {results: data.repository};
                        }
                    }
                    
                });
                //$( "#custom-select" ).select2();
            });
            /*
            .change(function() {
                var option = $(this.options[this.selectedIndex]).val();
                if(option === 'custom') {
                    //TODO: get Repos
                    $('#custom').show();
                } else {
                    //TODO: set gloabl repo for search
                    $('#custom').hide();
                }
            });
            */
            
            /*
            $.getJSON("/Users/GetUsers", null function(repos) {
                $("#custom select option").remove(); 
                $.each(repos.Repo, function(index, repo) { 
                    $("#custom" select).append( 
                        $("<option/>") 
                            .text(repo.name)
                            .val(repo.value)
                    );
                });
            });
*/
        </script>
    </body>
</html>